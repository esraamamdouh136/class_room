/**
 * @ag-grid-enterprise/multi-filter - Advanced Data Grid / Data Table supporting Javascript / React / AngularJS / Web Components * @version v26.0.0
 * @link http://www.ag-grid.com/
' * @license Commercial
 */

/**
 * @ag-grid-enterprise/multi-filter - Advanced Data Grid / Data Table supporting Javascript / React / AngularJS / Web Components * @version v26.0.0
 * @link http://www.ag-grid.com/
' * @license Commercial
 */
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t,e=require("@ag-grid-community/core"),n=require("@ag-grid-enterprise/core"),r=require("@ag-grid-enterprise/menu"),i=(t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)},function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}),o=function(){return(o=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},s=function(t,e,n,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(i=t[l])&&(s=(o<3?i(s):o>3?i(e,n,s):i(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},l=function(t){function n(){var e=t.call(this,'<div class="ag-multi-filter ag-menu-list-compact"></div>')||this;return e.filterDefs=[],e.filters=[],e.guiDestroyFuncs=[],e.activeFilterIndices=[],e.lastActivatedMenuItem=null,e.afterFiltersReadyFuncs=[],e}return i(n,t),n.prototype.postConstruct=function(){var t=this;this.initialiseTabGuard({onFocusIn:function(e){return t.onFocusIn(e)}})},n.getFilterDefs=function(t){var e=t.filters;return e&&e.length>0?e:[{filter:"agTextColumnFilter"},{filter:"agSetColumnFilter"}]},n.prototype.init=function(t){var r=this;this.params=t,this.filterDefs=n.getFilterDefs(t);var i=t.column,o=t.filterChangedCallback;this.column=i,this.filterChangedCallback=o;var s=[];return e._.forEach(this.filterDefs,(function(t,e){var n=r.createFilter(t,e);null!=n&&s.push(n)})),e.AgPromise.all(s).then((function(t){r.filters=t,r.refreshGui("columnMenu"),r.afterFiltersReadyFuncs.forEach((function(t){return t()})),r.afterFiltersReadyFuncs.length=0}))},n.prototype.refreshGui=function(t){var n=this;t!==this.lastOpenedInContainer&&(this.removeAllChildrenExceptTabGuards(),this.destroyChildren(),e._.forEach(this.filters,(function(r,i){i>0&&n.appendChild(e._.loadTemplate('<div class="ag-filter-separator"></div>'));var o,s=n.filterDefs[i],l=n.getFilterTitle(r,s);if("subMenu"===s.display&&"toolPanel"!==t)o=n.insertFilterMenu(r,l).getGui();else if("subMenu"===s.display||"accordion"===s.display){o=n.insertFilterGroup(r,l).getGui()}else o=r.getGui();n.appendChild(o)})),this.lastOpenedInContainer=t)},n.prototype.getFilterTitle=function(t,e){if(null!=e.title)return e.title;var n=t;return"function"==typeof n.getFilterTitle?n.getFilterTitle():"Filter"},n.prototype.destroyChildren=function(){e._.forEach(this.guiDestroyFuncs,(function(t){return t()})),this.guiDestroyFuncs.length=0},n.prototype.insertFilterMenu=function(t,e){var n=this,i=this.createBean(new r.MenuItemComponent({name:e,subMenu:t,cssClasses:["ag-multi-filter-menu-item"],isCompact:!0,isAnotherSubMenuOpen:function(){return!1}}));return i.setParentComponent(this),this.guiDestroyFuncs.push((function(){return n.destroyBean(i)})),this.addManagedListener(i,r.MenuItemComponent.EVENT_MENU_ITEM_ACTIVATED,(function(t){n.lastActivatedMenuItem&&n.lastActivatedMenuItem!==t.menuItem&&n.lastActivatedMenuItem.deactivate(),n.lastActivatedMenuItem=t.menuItem})),i.addGuiEventListener("focusin",(function(){return i.activate()})),i.addGuiEventListener("focusout",(function(){i.isSubMenuOpen()||i.deactivate()})),i},n.prototype.insertFilterGroup=function(t,n){var r=this,i=this.createBean(new e.AgGroupComponent({title:n,cssIdentifier:"multi-filter"}));if(this.guiDestroyFuncs.push((function(){return r.destroyBean(i)})),i.addItem(t.getGui()),i.toggleGroupExpand(!1),t.afterGuiAttached){var o={container:this.lastOpenedInContainer,suppressFocus:!0};i.addManagedListener(i,e.AgGroupComponent.EVENT_EXPANDED,(function(){return t.afterGuiAttached(o)}))}return i},n.prototype.isFilterActive=function(){return e._.some(this.filters,(function(t){return t.isFilterActive()}))},n.prototype.getLastActiveFilterIndex=function(){return this.activeFilterIndices.length>0?this.activeFilterIndices[this.activeFilterIndices.length-1]:null},n.prototype.doesFilterPass=function(t,e){var n=!0;return this.filters.forEach((function(r){n&&r!==e&&r.isFilterActive()&&(n=r.doesFilterPass(t))})),n},n.prototype.getFilterType=function(){return"multi"},n.prototype.getModelFromUi=function(){return{filterType:this.getFilterType(),filterModels:e._.map(this.filters,(function(t){var e=t;return"function"==typeof e.getModelFromUi?e.getModelFromUi():null}))}},n.prototype.getModel=function(){return this.isFilterActive()?{filterType:this.getFilterType(),filterModels:e._.map(this.filters,(function(t){return t.isFilterActive()?t.getModel():null}))}:null},n.prototype.setModel=function(t){var n=this,r=function(t,n){return new e.AgPromise((function(e){var r=t.setModel(n);r?r.then((function(){return e()})):e()}))},i=[];return null==t?i=e._.map(this.filters,(function(t,e){var i=r(t,null);return n.updateActiveList(e),i})):e._.forEach(this.filters,(function(e,o){var s=t.filterModels.length>o?t.filterModels[o]:null,l=r(e,s);i.push(l),n.updateActiveList(o)})),e.AgPromise.all(i).then((function(){}))},n.prototype.getChildFilterInstance=function(t){return this.filters[t]},n.prototype.afterGuiAttached=function(t){t&&this.refreshGui(t.container);var n=this.params.filters,r=n&&e._.some(n,(function(t){return t.display&&"inline"!==t.display}));this.executeFunctionIfExists("afterGuiAttached",o(o({},t||{}),{suppressFocus:r})),r&&this.forceFocusOutOfContainer(!0)},n.prototype.onAnyFilterChanged=function(){this.executeFunctionIfExists("onAnyFilterChanged")},n.prototype.onNewRowsLoaded=function(){this.executeFunctionIfExists("onNewRowsLoaded")},n.prototype.destroy=function(){var n=this;e._.forEach(this.filters,(function(t){t.setModel(null),n.destroyBean(t)})),this.filters.length=0,this.destroyChildren(),t.prototype.destroy.call(this)},n.prototype.executeFunctionIfExists=function(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];e._.forEachReverse(this.filters,(function(e){var r=e[t];"function"==typeof r&&r.apply(e,n)}))},n.prototype.createFilter=function(t,e){var n,r=this,i=this.params,s=i.filterModifiedCallback,l=i.doesRowPassOtherFilter,a=o(o({},this.filterManager.createFilterParams(this.column,this.column.getColDef())),{filterModifiedCallback:s,filterChangedCallback:function(t){r.executeWhenAllFiltersReady((function(){return r.filterChanged(e,t)}))},doesRowPassOtherFilter:function(t){return l(t)&&r.doesFilterPass({node:t,data:t.data},n)}}),u=this.userComponentFactory.newFilterComponent(t,a,"agTextColumnFilter");return null!=u?u.then((function(t){return n=t})):u},n.prototype.executeWhenAllFiltersReady=function(t){this.filters&&this.filters.length>0?t():this.afterFiltersReadyFuncs.push(t)},n.prototype.updateActiveList=function(t){var n=this.filters[t];e._.removeFromArray(this.activeFilterIndices,t),n.isFilterActive()&&this.activeFilterIndices.push(t)},n.prototype.filterChanged=function(t,n){this.updateActiveList(t),this.filterChangedCallback(n);var r=this.filters[t];e._.forEach(this.filters,(function(t){t!==r&&"function"==typeof t.onAnyFilterChanged&&t.onAnyFilterChanged()}))},n.prototype.onFocusIn=function(t){return null==this.lastActivatedMenuItem||this.lastActivatedMenuItem.getGui().contains(t.target)||(this.lastActivatedMenuItem.deactivate(),this.lastActivatedMenuItem=null),!0},s([e.Autowired("filterManager")],n.prototype,"filterManager",void 0),s([e.Autowired("userComponentFactory")],n.prototype,"userComponentFactory",void 0),s([e.PostConstruct],n.prototype,"postConstruct",null),n}(e.TabGuardComp),a=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),u=function(){return(u=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},c=function(t,e,n,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(i=t[l])&&(s=(o<3?i(s):o>3?i(e,n,s):i(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},f=function(t){function n(){var e=t.call(this,'<div class="ag-multi-floating-filter ag-floating-filter-input"></div>')||this;return e.floatingFilters=[],e}return a(n,t),n.prototype.init=function(t){var n=this;this.params=t;var r=t.filterParams,i=[];return e._.forEach(l.getFilterDefs(r),(function(e,r){var o=u(u({},t),{parentFilterInstance:function(e){t.parentFilterInstance((function(t){var n=t.getChildFilterInstance(r);e(n)}))}}),s=n.createFloatingFilter(e,o);null!=s&&i.push(s)})),e.AgPromise.all(i).then((function(t){e._.forEach(t,(function(t,r){n.floatingFilters.push(t);var i=t.getGui();n.appendChild(i),r>0&&e._.setDisplayed(i,!1)}))}))},n.prototype.onParentModelChanged=function(t,n){var r=this;n&&n.afterFloatingFilter||this.params.parentFilterInstance((function(i){if(null==t)e._.forEach(r.floatingFilters,(function(t,r){t.onParentModelChanged(null,n),e._.setDisplayed(t.getGui(),0===r)}));else{var o=i.getLastActiveFilterIndex();e._.forEach(r.floatingFilters,(function(r,i){var s=t.filterModels.length>i?t.filterModels[i]:null;r.onParentModelChanged(s,n);var l=null==o?0===i:i===o;e._.setDisplayed(r.getGui(),l)}))}}))},n.prototype.destroy=function(){this.destroyBeans(this.floatingFilters),this.floatingFilters.length=0,t.prototype.destroy.call(this)},n.prototype.createFloatingFilter=function(t,n){var r=e.FloatingFilterWrapper.getDefaultFloatingFilterType(t)||"agTextColumnFloatingFilter";return this.userComponentFactory.newFloatingFilterComponent(t,n,r)},c([e.Autowired("userComponentFactory")],n.prototype,"userComponentFactory",void 0),n}(e.Component),p={moduleName:e.ModuleNames.MultiFilterModule,beans:[],userComponents:[{componentName:"agMultiColumnFilter",componentClass:l},{componentName:"agMultiColumnFloatingFilter",componentClass:f}],dependantModules:[n.EnterpriseCoreModule]};exports.MultiFilter=l,exports.MultiFilterModule=p;