/**
 * @ag-grid-enterprise/master-detail - Advanced Data Grid / Data Table supporting Javascript / React / AngularJS / Web Components * @version v26.0.0
 * @link http://www.ag-grid.com/
' * @license Commercial
 */

/**
 * @ag-grid-enterprise/master-detail - Advanced Data Grid / Data Table supporting Javascript / React / AngularJS / Web Components * @version v26.0.0
 * @link http://www.ag-grid.com/
' * @license Commercial
 */
import{RowNode as e,_ as t,Autowired as r,BeanStub as i,Grid as a,RefSelector as s,Component as o,ModuleNames as n}from"@ag-grid-community/core";import{EnterpriseCoreModule as l}from"@ag-grid-enterprise/core";var p,d=(p=function(e,t){return(p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}p(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),c=function(){return(c=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},h=function(e,t,r,i){var a,s=arguments.length,o=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,i);else for(var n=e.length-1;n>=0;n--)(a=e[n])&&(o=(s<3?a(o):s>3?a(t,r,o):a(t,r))||o);return s>3&&o&&Object.defineProperty(t,r,o),o},f=function(i){function a(){var e=null!==i&&i.apply(this,arguments)||this;return e.loadRowDataVersion=0,e.needRefresh=!1,e}return d(a,i),a.prototype.init=function(t,r){var i=this;this.params=r,this.comp=t,null!=r.pinned||(this.setAutoHeightClasses(),this.checkForDeprecations(),this.ensureValidRefreshStrategy(),this.addThemeToDetailGrid(),this.createDetailGrid(),this.loadRowData(),this.addManagedListener(r.node.parent,e.EVENT_DATA_CHANGED,(function(){i.needRefresh=!0})))},a.prototype.setAutoHeightClasses=function(){var e=this.gridOptionsWrapper.isDetailRowAutoHeight(),t=e?"ag-details-row-auto-height":"ag-details-row-fixed-height",r=e?"ag-details-grid-auto-height":"ag-details-grid-fixed-height";this.comp.addOrRemoveCssClass(t,!0),this.comp.addOrRemoveDetailGridCssClass(r,!0)},a.prototype.checkForDeprecations=function(){this.params.suppressRefresh&&(console.warn("AG Grid: as of v23.2.0, cellRendererParams.suppressRefresh for Detail Cell Renderer is no longer used. Please set cellRendererParams.refreshStrategy = 'nothing' instead."),this.params.refreshStrategy="nothing")},a.prototype.ensureValidRefreshStrategy=function(){switch(this.params.refreshStrategy){case"rows":case"nothing":case"everything":return}this.params.refreshStrategy&&console.warn("AG Grid: invalid cellRendererParams.refreshStrategy = '"+this.params.refreshStrategy+"' supplied, defaulting to refreshStrategy = 'rows'."),this.params.refreshStrategy="rows"},a.prototype.addThemeToDetailGrid=function(){var e=this.environment.getTheme().theme;e&&this.comp.addOrRemoveDetailGridCssClass(e,!0)},a.prototype.createDetailGrid=function(){if(t.missing(this.params.detailGridOptions))console.warn("AG Grid: could not find detail grid options for master detail, please set gridOptions.detailCellRendererParams.detailGridOptions");else{var e=this.gridOptionsWrapper.isDetailRowAutoHeight(),r=c({},this.params.detailGridOptions);e&&(r.domLayout="autoHeight"),this.comp.setDetailGrid(r)}},a.prototype.registerDetailWithMaster=function(e,t){var r=this.params.node.id,i=this.params.api,a={id:r,api:e,columnApi:t},s=this.params.node;i.addDetailGridInfo(r,a),s.detailGridInfo=a,this.addDestroyFunc((function(){i.removeDetailGridInfo(r),s.detailGridInfo=null}))},a.prototype.loadRowData=function(){var e=this;this.loadRowDataVersion++;var t=this.loadRowDataVersion,r=this.params.getDetailRowData;if(r){r({node:this.params.node,data:this.params.node.data,successCallback:function(r){e.loadRowDataVersion===t&&e.comp.setRowData(r)},context:this.gridOptionsWrapper.getContext()})}else console.warn("AG Grid: could not find getDetailRowData for master / detail, please set gridOptions.detailCellRendererParams.getDetailRowData")},a.prototype.refresh=function(){return!this.needRefresh||"nothing"===this.params.refreshStrategy||(this.needRefresh=!1,"everything"!==this.params.refreshStrategy&&(this.loadRowData(),!0))},h([r("environment")],a.prototype,"environment",void 0),a}(i),u=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),m=function(e,t,r,i){var a,s=arguments.length,o=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,i);else for(var n=e.length-1;n>=0;n--)(a=e[n])&&(o=(s<3?a(o):s>3?a(t,r,o):a(t,r))||o);return s>3&&o&&Object.defineProperty(t,r,o),o},g=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return u(r,e),r.prototype.init=function(e){var r=this;this.params=e,this.selectAndSetTemplate();var i={addOrRemoveCssClass:function(e,t){return r.addOrRemoveCssClass(e,t)},addOrRemoveDetailGridCssClass:function(e,i){return t.addOrRemoveCssClass(r.eDetailGrid,e,i)},setDetailGrid:function(e){return r.setDetailGrid(e)},setRowData:function(e){return r.setRowData(e)}};this.ctrl=this.createManagedBean(new f),this.ctrl.init(i,e)},r.prototype.refresh=function(){return this.ctrl&&this.ctrl.refresh()},r.prototype.destroy=function(){e.prototype.destroy.call(this)},r.prototype.selectAndSetTemplate=function(){var e=this;if(this.params.pinned)this.setTemplate('<div class="ag-details-row"></div>');else{var i=function(){e.setTemplate(r.TEMPLATE)};if(t.missing(this.params.template))i();else if("string"==typeof this.params.template)this.setTemplate(this.params.template);else if("function"==typeof this.params.template){var a=(0,this.params.template)(this.params);this.setTemplate(a)}else console.warn("AG Grid: detailCellRendererParams.template should be function or string"),i();null==this.eDetailGrid&&console.warn('AG Grid: reference to eDetailGrid was missing from the details template. Please add ref="eDetailGrid" to the template.')}},r.prototype.setDetailGrid=function(e){this.eDetailGrid&&(new a(this.eDetailGrid,e,{$scope:this.params.$scope,$compile:this.params.$compile,providedBeanInstances:{agGridReact:this.params.agGridReact,frameworkComponentWrapper:this.params.frameworkComponentWrapper}}),this.detailApi=e.api,this.ctrl.registerDetailWithMaster(e.api,e.columnApi),this.addDestroyFunc((function(){e.api&&e.api.destroy()})))},r.prototype.setRowData=function(e){this.detailApi&&this.detailApi.setRowData(e)},r.TEMPLATE='<div class="ag-details-row">\n            <div ref="eDetailGrid" class="ag-details-grid"></div>\n        </div>',m([s("eDetailGrid")],r.prototype,"eDetailGrid",void 0),r}(o),y={moduleName:n.MasterDetailModule,beans:[],userComponents:[{componentName:"agDetailCellRenderer",componentClass:g}],controllers:[{controllerName:"detailCellRenderer",controllerClass:f}],dependantModules:[l]};export{y as MasterDetailModule};